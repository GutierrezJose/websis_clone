generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model career {
  id_career      Int              @id @default(autoincrement())
  name           String           @unique @db.VarChar(100)
  career_subject career_subject[]
  student_career student_career[]
}

model career_subject {
  id_career_subject                           Int          @id @default(autoincrement())
  id_career                                   Int?
  id_subject                                  Int?
  requirement                                 Int?
  level                                       String       @db.VarChar(1)
  group                                       String       @db.VarChar(3)
  career                                      career?      @relation(fields: [id_career], references: [id_career], onDelete: NoAction, onUpdate: NoAction)
  subject_career_subject_id_subjectTosubject  subject?     @relation("career_subject_id_subjectTosubject", fields: [id_subject], references: [id_subject], onDelete: NoAction, onUpdate: NoAction)
  subject_career_subject_requirementTosubject subject?     @relation("career_subject_requirementTosubject", fields: [requirement], references: [id_subject], onDelete: NoAction, onUpdate: NoAction)
  enrollment                                  enrollment[]
}

model enrollment {
  id_enrollment     Int             @id(map: "user_career_subject_pkey") @default(autoincrement())
  id_user           Int?
  id_career_subject Int?
  id_period         Int?
  year              String          @db.VarChar(255)
  career_subject    career_subject? @relation(fields: [id_career_subject], references: [id_career_subject], onDelete: NoAction, onUpdate: NoAction, map: "user_career_subject_id_career_subject_fkey")
  period            period?         @relation(fields: [id_period], references: [id_period], onDelete: NoAction, onUpdate: NoAction, map: "user_career_subject_id_period_fkey")
  user              user?           @relation(fields: [id_user], references: [id_user], onDelete: NoAction, onUpdate: NoAction, map: "user_career_subject_id_user_fkey")
  grade             grade[]
}

model grade {
  id_grade      Int         @id @default(autoincrement())
  id_enrollment Int?
  first_exam    BigInt?
  second_examen BigInt?
  final_exam    BigInt?
  grade         BigInt?
  status        String?     @db.VarChar(100)
  enrollment    enrollment? @relation(fields: [id_enrollment], references: [id_enrollment], onDelete: NoAction, onUpdate: NoAction, map: "grade_id_user_career_subject_fkey")
}

model period {
  id_period  Int          @id @default(autoincrement())
  name       String       @unique @db.VarChar(100)
  enrollment enrollment[]
}

model professor_subject {
  id_professor_subject Int      @id(map: "user_subject_pkey") @default(autoincrement())
  id_user              Int?
  id_subject           Int?
  subject              subject? @relation(fields: [id_subject], references: [id_subject], onDelete: NoAction, onUpdate: NoAction, map: "user_subject_id_subject_fkey")
  user                 user?    @relation(fields: [id_user], references: [id_user], onDelete: NoAction, onUpdate: NoAction, map: "user_subject_id_user_fkey")
}

model rol {
  id_rol   Int        @id @default(autoincrement())
  name     String     @unique @db.VarChar(30)
  user_rol user_rol[]
}

model student_career {
  id_student_career Int     @id(map: "user_career_pkey") @default(autoincrement())
  id_user           Int?
  id_career         Int?
  career            career? @relation(fields: [id_career], references: [id_career], onDelete: NoAction, onUpdate: NoAction, map: "user_career_id_career_fkey")
  user              user?   @relation(fields: [id_user], references: [id_user], onDelete: NoAction, onUpdate: NoAction, map: "user_career_id_user_fkey")
}

model subject {
  id_subject                                         Int                 @id @default(autoincrement())
  name                                               String              @unique @db.VarChar(255)
  career_subject_career_subject_id_subjectTosubject  career_subject[]    @relation("career_subject_id_subjectTosubject")
  career_subject_career_subject_requirementTosubject career_subject[]    @relation("career_subject_requirementTosubject")
  professor_subject                                  professor_subject[]
}

model user {
  id_user           Int                 @id @default(autoincrement())
  username          String              @db.VarChar(50)
  password          String              @db.VarChar(255)
  first_name        String?             @db.VarChar(100)
  last_name         String?             @db.VarChar(100)
  ci                Int
  birthdate         DateTime?           @db.Date
  address           String?             @db.VarChar(255)
  phone             String?             @db.VarChar(50)
  enrollment        enrollment[]
  professor_subject professor_subject[]
  student_career    student_career[]
  user_rol          user_rol[]
}

model user_rol {
  id_user_rol Int   @id @default(autoincrement())
  id_user     Int?
  id_rol      Int?
  rol         rol?  @relation(fields: [id_rol], references: [id_rol], onDelete: NoAction, onUpdate: NoAction)
  user        user? @relation(fields: [id_user], references: [id_user], onDelete: NoAction, onUpdate: NoAction)
}
